import tkinter as tk
import tkinter.ttk as ttk
from tkinter.filedialog import asksaveasfilename
from tkinter.filedialog import askopenfilename
import os
from tkinter import messagebox
import shutil
from PIL import ImageTk, Image

#create main window
def create_main_window():
    global top
    global root
    img=b'iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABhWlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9ba0upKNhBxCFDdbIgKuIoVSyChdJWaNXB5NIvaNKQpLg4Cq4FBz8Wqw4uzro6uAqC4AeIo5OToouU+L+k0CLGg+N+vLv3uHsHeJtVphg9E4Cimno6ERdy+VUh8IpehBCEHwMiM7RkZjEL1/F1Dw9f72I8y/3cn6NPLhgM8AjEc0zTTeIN4plNU+O8TxxhZVEmPice1+mCxI9clxx+41yy2cszI3o2PU8cIRZKXSx1MSvrCvE0cVRWVMr35hyWOW9xVqp11r4nf2G4oK5kuE5zBAksIYkUBEioo4IqTMRoVUkxkKb9uIt/2PanyCWRqwJGjgXUoEC0/eB/8Ltbozg16SSF44D/xbI+RoHALtBqWNb3sWW1TgDfM3Cldvy1JjD7SXqjo0WPgP5t4OK6o0l7wOUOMPSkibpoSz6a3mIReD+jb8oDg7dAaM3prb2P0wcgS10t3wAHh8BYibLXXd4d7O7t3zPt/n4A/75yeXvunoQAAAAGYktHRAAAAAAAAPlDu38AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfmBgoICBVHI3igAAAAGXRFWHRDb21tZW50AENyZWF0ZWQgd2l0aCBHSU1QV4EOFwAAA6VJREFUWMPlV01IMmsUfsYCISKhVEhdiQStJHSltDBDiDIh+hlsEW1y01a3EbQIg9rUPimklYIZbYpplYt+KTRIyFmkQhNo2aJQ5tzV7d75dGzsu9zvu9wDs3rP+8w55znned+XEUWR8AtNhV9s7a1ueHp6QiqVQiqVwvX1NQDAarXC4XDA4XBAp9O1hMcopaBWqyGZTCIcDsPtdsPlckGv14OIIAgCOI7D8fExgsEgvF4v2tsV5iaKIn31VatV2tjYIJZlKZ1Oy/ql02liWZbW19epWq2SEmxFAcRiMWJZlgRB+NJXEARiWZZisZiiABpSUKlUwHEcTk5OcHNzg0qlgu3tbfT390v8Dg4OEI1GMTExgbGxMajVagDA3d0d5ubm0NHRAavViqGhIbhcLnR1dX3dA9lsFqFQCGazGV6vFzqdDiqVqu7nALCzs4NMJoNSqQSz2YxgMAiGYT6D+LM/kskkstkswuEw+vr65HugUCjQ8PAwxWIxRRxGIhGKRCIkCAI5nU7ieb6hX61Wo3g8Tm63m/L5vGRN9WNG4+Pj8Pl8aGtrUzxKPT092Nvbg8FgaCw2KhV8Ph98Ph92d3cbV6BUKpHdbqdcLtc066OjI/L7/eT3+2l+fp4ikYiiZhNFkXieJ5vNRqVSqb4Cz8/PAACj0Sib6e3tLVZWVhAIBBAIBMDzfEuiYzAYwDDM579aVsJ0Oo2ZmRkMDg4CACYnJ0Gk/Chp5PtZAa1WCyJCoVCQBdDr9Tg7O0O5XEa5XMbl5SVMJpPiAIrFIogIWq22PgCNRoPp6WkkEglZAKfTCZPJBI/HA4/HA6PRCKfTqTiARCKBqakpaDSaxmOYz+fJ7XZTPB6nWq0mO1I8z1Mul5P1aWUM64To/v4eoVAIFotFIkTfMVEUIQgC9vf3kc1msba2VidEDaX49fUVHMeB4zhcXV3h4+PjWwGo1WoMDAzA5XIpl+L/943o8PAQy8vLEoelpSWMjIxgcXER5+fnkvJGo1EAwOzsLN7f3z/X7HY7Njc3m+I1pODl5QXFYlGyobe3FxqNBo+Pj3h7e/trI8PAYrGAiPDw8ABRFD/XOjs7YTKZmuL9NAUMw7SkgoooOD09lS3Z6uqqLAULCwsNKWiG99tMgaQCmUwGFxcXEge73d7wNvT3vkkmk5Ie6O7uxujoqCI81Y+8KjnBWumTr/B+Lwq+Y/l8Hn6/XyLXNpsNW1tb/+zLqNmLSU4H/pUA/vNnwR8H97llVEK/YAAAAABJRU5ErkJggg=='
    root= tk.Tk()
    top= root
    top.geometry("120x80")
    top.title("Bitrate Reduction")
    top.resizable(0,0)
    favicon=tk.PhotoImage(data=img) 
    root.wm_iconphoto(True, favicon)

#create_buttons
def create_buttons():
    global convert_button
    convert_button=tk.Button(top)
    convert_button.place(x=20,y=20,height=40,width=80)
    convert_button.configure(text="Convert")
    convert_button.bind("<Button-1>",open_file)

#open_file
def open_file(event):
    global soundfilename
    data=[('WAV', '*.wav')]
    soundfilename=askopenfilename(filetypes=data, defaultextension=data)
    #if str(soundfile)!='':
    convert()

#convert_bitrate
def convert():
    headerbytes= b'BM\x8a\xb0\x04\x00\x00\x00\x00\x00\x8a\x00\x00\x00|\x00\x00\x00\xf0\x00\x00\x00\x80\x02\x00\x00\x01\x00\x10\x00\x03\x00\x00\x00\x00\xb0\x04\x00#.\x00\x00#.\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf8\x00\x00\xe0\x07\x00\x00\x1f\x00\x00\x00\x00\x00\x00\x00BGRs\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc69iJ\x8aJ\xabR\xabR\xabR\xcbRIB\xe5\x18\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x84\x10\xa4\x10\x84\x10\x84\x10\x84\x10\xa4\x10\x83\x10\xa4\x10\x84\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x08\xa4\x10\xa4\x10\xa4\x10\xa3\x10\x84\x10\x84\x10\xa4\x10\xc4\x10\xa4\x10\xa4\x10\x84\x10\xa4\x10\x84\x10\x84\x10\x83\x08c\x08\x83\x08\xa4\x10\xe5\x18\xe5\x10\xe5\x10\xe5\x10\xc5\x10\xc5\x10\xc5\x10\xc5\x10\xc5\x10\xc5\x10\xc5\x10\xc5\x10\xc5\x10\xc5\x10\xe5\x10\xe6\x10\xe6\x18\xe6\x18\xe5\x18\xe5\x10\xe5\x10\xe5\x10\xe5\x10\x05\x11\x05\x11\x06\x19\xe5\x18\xe6\x18\xe6\x18\xe6\x18\x06\x11\x06\x11\xe6\x10\x06\x11\x06\x11\x06\x11\x06\x11\x06\x11\x06\x11\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\xe6\x18\x06\x19\x06\x19\x06\x19\x06\x11\x06\x11\x06\x11\xe6\x10\xe6\x18\xe6\x18\xe6\x18\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19&\x19\x06\x19\x06\x19\x06\x19\x06\x19\xe6\x18\x06!KRU\xa5\xda\xd6\xfa\xde\xfa\xde\xfa\xde\xfa\xde\xfa\xde\xfa\xde\xfa\xde\xfa\xde\xfa\xde\xfa\xde\xda\xde\xda\xde\xfa\xde\xfa\xde\xda\xde\xd9\xde\xd9\xd6\xd9\xd6\xd9\xd6\xb9\xd6\xb9\xd6\xb9\xd6\xb9\xd6\xb8\xd6\x98\xd6\x98\xce\x98\xce\x98\xcex\xcex\xcex\xc6X\xc6W\xc67\xc67\xbe\x17\xbe\x16\xbe\xf6\xb5\xf6\xb5\xf6\xb5\xd6\xb5\xd6\xad\xb5\xad\x95\xad\x95\xad\x95\xa5t\xa5t\xa5T\x9dT\x9d4\x9d3\x9d3\x9d\x13\x9d\x13\x9d\xf2\x9c\xf2\x94\xd2\x94\xd2\x94\xd2\x94\xd2\x94\xd1\x94\xb1\x94\xb1\x94\xb1\x94\x91\x94\x91\x8c\x90\x8c\x90\x8cp\x8co\x8co\x8cO\x8cO\x84O\x84.\x84.\x84.\x84\x0e\x84\r|\r|\xed{\xed{\xcc{\xcc{\xcc{\xac{\xac{\xab{\x8b{\x8bs\xe79IJ\xaaR\xabR\xabR\xabR\xcbR\x08:\xc4\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x83\x10\x84\x10\x84\x10\x84\x10\x84\x10\x84\x10\x84\x10\xa4\x10\x84\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\x84\x08\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa3\x10\x83\x10\x84\x10\x84\x10\xa4\x10\xc4\x10\xc5\x10\xc4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\xa4\x10\x84\x08c\x08\x84\x10\xc5\x10\xe5\x10\xe5\x10\xe5\x10\xe5\x10\xc5\x10\xc5\x10\xc5\x10\xc5\x10\xc5\x10\xc5\x10\xa5\x10\xc5\x10\xc5\x10\xc5\x10\xe5\x10\xe6\x18\xe6\x18\xe6\x18\x06\x19\xe6\x18\x05\x19\xe5\x10\xe5\x10\x05\x11\x06\x19\xe6\x18\xe6\x18\x06\x19\x06\x19\x06\x11\x06\x11\x06\x11\xe6\x10\x06\x11\x06\x11\x06\x11\x06\x11\x06\x11\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x19\x06\x11\xe6\x18\xe6\x18\xe6\x18\xe6\x18\x06'
    soundfile=open(soundfilename,'rb')
    tempfile=open("tempfile.bmp",'wb')
    tempfile.write(headerbytes)
    soundfilesize=os.path.getsize(soundfilename)
    for n in range (45, 460800):
        if soundfilesize>460800:
            soundfile.seek(n)
        elif soundfilesize<460800 and n==soundfilesize:
            soundfile.seek(1)
        byteread=soundfile.read(1)
        tempfile.write(byteread)
    imgfile=Image.open("tempfile.bmp")    
    img=imgfile.convert("L", palette=Image.Palette.ADAPTIVE, dither=Image.Dither.FLOYDSTEINBERG, colors=256)
    data=[('BMP','*.bmp')]
    bmpfilesavename=asksaveasfilename(filetypes=data, defaultextension=data)
    img.save(bmpfilesavename)
    tempfile.close()
    soundfile.close()
    os.remove("tempfile.bmp")
    imgfileshow=Image.open(bmpfilesavename)
    imgfileshow.show()
    
        

#main             
def main():
        create_main_window()
        create_buttons()

main()
root.mainloop()
